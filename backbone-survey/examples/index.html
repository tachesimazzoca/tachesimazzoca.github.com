<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>backbone-survey/examples</title>
<script type="text/javascript" src="../lib/json2/json2.js"></script>
<script type="text/javascript" src="../lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../lib/underscore/underscore-min.js"></script>
<script type="text/javascript" src="../lib/backbone/backbone-min.js"></script>
<script type="text/javascript" src="../assets/js/backbone-survey.js"></script>
<script type="text/javascript">
(function($) {
  $(function() {
    var survey = new BackboneSurvey.Survey({
      survey: {
        title: "テストアンケート"
      , page: 0
      }
    , sections: [
        {
          id: "startup"
        , page: 1
        , question: "回答なしのセクションです。案内文を表示することができます。"
        }
      , {
          id: 'Invalid ID!!(^^;)'
        , page: 1
        , question: "IDに利用可能な文字は [-_0-9a-zA-Z]+ です。不正IDの設問は読み込まれません"
        }
      , {
          id: "q1"
        , page: 2
        , question: "Q1. テキスト入力設問です。<strong><em>HTMLタグはエスケープされません</em></strong>"
        , type: BackboneSurvey.QuestionType.TEXT
        , label: "<strong>ラベル：</strong>"
        , guide: "<em>(2..10文字以内)</em>"
        , rules: [
            new BackboneSurvey.RequiredValidator({ message: "入力してください" })
          , new BackboneSurvey.RangeLengthValidator({
              message: "2..10文字以内で入力してください"
            , min: 2
            , max: 10
            })
          ]
        }
      , {
          id: "q2"
          // page 値を合わせることで、複数設問を表示できます。
        , page: 2
        , question: "Q2. 単一選択設問です。"
        , type: BackboneSurvey.QuestionType.RADIO
        , options: [
            { value: "1", label: "はい" }
          , { value: "2", label: "いいえ" }
          , { value: "0", label: "どちらともいえない" }
          ]
        , rules: [
            new BackboneSurvey.RequiredValidator({ message: "選択してください" })
          ]
        }
      , {
          id: "q3"
        , page: 3
        , question: "Q3. 複数選択設問です。(未選択可)"
        , type: BackboneSurvey.QuestionType.CHECKBOX
        , options: [
            { value: "A", label: "スポーツ" }
          , { value: "B", label: "読書" }
          , { value: "C", label: "映画鑑賞" }
          , { value: "NONE", label: "特になし" }
          , { value: "OTHER", label: "その他" }
          ]
        // 背反値です。
        , singleOptions: ["NONE", "OTHER"]
        // 初期値です。背反制御と矛盾しているため "NONE" のチェックは外れます。
        , defaultOptionAnswers: ["B", "C", "NONE"]
        }
      , {
          id: "q4"
        , page: 4
        , question: "Q4. 複数選択設問です。(選択必須)"
        , type: BackboneSurvey.QuestionType.CHECKBOX
        // ラベルを省略して値のみ指定できます。
        , options: [ "赤", "緑", "青" ]
        , rules: [
            new BackboneSurvey.RequiredValidator({ message: "選択してください" })
          ]
        }
      ]
    }, { parse: true });

    var view = new BackboneSurvey.SurveyView({
      model: survey // BackboneSurvey.Survey
    , el: $("#survey-app") // アンケートを表示する jQuery オブジェクト
    });
    // 回答完了後に completed でイベントフックが呼ばれます。
    view.on("completed", function() {
      console.log(["completed", survey.answers()]); });
    // SurveyView#startPage() でアンケート開始します。
    view.startPage();
  });
})(jQuery);
</script>
</head>
<body>
  <div id="survey-app">
    <h1 class="survey-title"></h1><!-- アンケートタイトル -->
    <div id="survey-sections"></div><!-- アンケート設問(必須) -->
    <input type="button" class="survey-next" value="Next"><!-- 次ページに進みます(必須) -->
    <input type="button" class="survey-prev" value="Prev"><!-- 前ページに戻ります -->
    <p><a class="survey-start" href="javascript:void(0);">はじめからやり直す</a></p>
  </div>
</body>
</html>
